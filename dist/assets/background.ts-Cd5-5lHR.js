chrome.action.onClicked.addListener(async e=>{if(e.id)try{await chrome.tabs.sendMessage(e.id,{type:"TOGGLE_SIDEBAR"})}catch{console.log("Content script not loaded yet, injecting...")}});chrome.runtime.onMessage.addListener((e,r,t)=>e.type==="CAPTURE_SCREENSHOT"?(c(e.tabId,e.options).then(a=>t(a)).catch(a=>t({success:!1,error:a.message})),!0):e.type==="GET_CURRENT_TAB"?(n().then(a=>t({success:!0,tab:a})).catch(a=>t({success:!1,error:a.message})),!0):!1);chrome.commands.onCommand.addListener(async e=>{const[r]=await chrome.tabs.query({active:!0,currentWindow:!0});if(r!=null&&r.id){if(e==="_execute_action")try{await chrome.tabs.sendMessage(r.id,{type:"TOGGLE_SIDEBAR"})}catch{console.log("Content script not loaded")}if(e==="save_current_page")try{await chrome.tabs.sendMessage(r.id,{type:"TRIGGER_SAVE"})}catch{console.log("Content script not loaded")}}});async function c(e,r){try{const t=await chrome.tabs.get(e);if(!t.windowId)throw new Error("Tab window not found");return{success:!0,dataUrl:await chrome.tabs.captureVisibleTab(t.windowId,{format:r.format||"jpeg",quality:r.quality||80})}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Screenshot capture failed"}}}async function n(){const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e||null}console.log("SideVault background service worker initialized");
//# sourceMappingURL=background.ts-Cd5-5lHR.js.map
