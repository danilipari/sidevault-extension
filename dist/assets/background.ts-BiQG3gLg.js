chrome.action.onClicked.addListener(async e=>{e.id&&await chrome.sidePanel.open({tabId:e.id})});chrome.runtime.onMessage.addListener((e,t,r)=>e.type==="CAPTURE_SCREENSHOT"?(n(e.tabId,e.options).then(a=>r(a)).catch(a=>r({success:!1,error:a.message})),!0):e.type==="GET_CURRENT_TAB"?(c().then(a=>r({success:!0,tab:a})).catch(a=>r({success:!1,error:a.message})),!0):!1);chrome.commands.onCommand.addListener(async e=>{if(e==="save_current_page"){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});t!=null&&t.id&&(await chrome.sidePanel.open({tabId:t.id}),setTimeout(()=>{chrome.runtime.sendMessage({type:"TRIGGER_SAVE",tab:t})},300))}});async function n(e,t){try{const r=await chrome.tabs.get(e);if(!r.windowId)throw new Error("Tab window not found");return{success:!0,dataUrl:await chrome.tabs.captureVisibleTab(r.windowId,{format:t.format||"jpeg",quality:t.quality||80})}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Screenshot capture failed"}}}async function c(){const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});return e||null}chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(e=>console.error("Failed to set panel behavior:",e));console.log("SideVault background service worker initialized");
//# sourceMappingURL=background.ts-BiQG3gLg.js.map
